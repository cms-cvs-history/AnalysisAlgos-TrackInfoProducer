 process TRACKINFOS = {

  source = PoolSource
  {
    untracked vstring fileNames = 
{"castor:/castor/cern.ch/user/c/chiorbo/CosmicRootFiles/rootfiles/ReprocessedRecHits/cosmic_B4_ReprocessedRecHits_3.root"}
#   untracked vstring fileNames = {"file:TrackInfo.root"	}
    untracked int32 maxEvents = 10
  }

    # include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "MagneticField/Engine/data/uniformMagneticField.cfi"
    replace UniformMagneticFieldESProducer.ZFieldInTesla = 4.0
    # default value of ZFieldInTesla is zero
  ############### initialize geometry #####################
    include "Geometry/CMSCommonData/data/cmsMTCCGeometryXML.cfi"
  #  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
    include "RecoTracker/GeometryESProducer/data/TrackerRecoGeometryESProducer.cfi"
  # stripCPE
    include "RecoLocalTracker/SiStripRecHitConverter/data/StripCPEfromTrackAngle.cfi"
  # pixelCPE
    include "RecoLocalTracker/SiPixelRecHits/data/PixelCPEParmError.cfi"
  #TransientTrackingBuilder
    include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilder.cfi"

es_module = MisalignedTrackerESProducer
   {
       // General settings
       string distribution = 'fixed'
       int32 seed = 1234567
       bool  setError = false
       untracked bool saveToDbase = false
       PSet BarrelLayers = {
           bool setError = true
       #APE = dX * scale * scaleError
       #(1mm)
      #     double dX = 0.1
      #     double scaleError = 10000
      #     double scale = 0.0001
        #sqrt(APE) (because of APE bug)
        #(1mm)
           double dX = 0.316227766
           double scaleError = 100
           double scale = 0.01
       }
#  PSet TIB1 = { double phiZ = -0.0628
#       double dX = -4.2705 }
}

  module cosmicseeds= CosmicSeedGenerator{
     	InputTag matchedRecHits = siStripMatchedRecHits:matchedRecHit
    	InputTag rphirecHits    = siStripMatchedRecHits:rphiRecHit
    	InputTag stereorecHits  = siStripMatchedRecHits:stereoRecHit
    double ptMin=0.9
    double originRadius=150
    double originHalfLength=90
    double originZPosition=0
    string TTRHBuilder        =  "WithTrackAngle"
    untracked string GeometricStructure  = "MTCC"
   }

module cosmictrack= CosmicTrackFinder{
 bool TrajInEvents=true
 InputTag cosmicSeeds = cosmicseeds:
 InputTag matchedRecHits = siStripMatchedRecHits:matchedRecHit
 InputTag rphirecHits    = siStripMatchedRecHits:rphiRecHit
 InputTag stereorecHits  = siStripMatchedRecHits:stereoRecHit
 string HitProducer        = "siStripRecHits"
 int32 MinHits=3
 double Chi2Cut=40.
 string TTRHBuilder   =       "WithTrackAngle"
 untracked  string GeometricStructure ="MTCC"
 }

include "AnalysisAlgos/TrackInfoProducer/data/TrackInfoProducer.cfi"
replace  trackinfo.cosmicTracks = cosmictrack
replace  trackinfo.rechits =cosmictrack

#module dump = EventContentAnalyzer {}
#        module trackInfoAnalyzer =  TrackInfoAnalyzer{
#        InputTag TrackInfo=trackinfo
#        }

  module out = PoolOutputModule
  {
    untracked string fileName = "TrackInfo2.root"
  }

 path p =
  {
 cosmicseeds,
cosmictrack,
trackinfo
  }

  endpath e =
  {
    out
  }
}
